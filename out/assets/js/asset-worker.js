self.addEventListener("message",e=>{switch(e.data.type){case"LOAD_ASSET":{let{assetId:t,id:a}=e.data;(async(e,t)=>{try{let a=e?.replace(/^\/+/,""),s=await fetch(`/assets/${a}`);t({content:await s.text(),type:s.headers.get("Content-Type")||"text/plain"}),s.ok||(console.error(`Failed to load asset: ${s.statusText}`),t({error:`Failed to load asset: ${s.statusText}`}))}catch(e){console.error("Error loading asset:",e),t({error:"An unexpected error occurred while loading the asset."})}})(t,e=>{self.postMessage({type:"ASSET_LOADED",data:{id:a,assetId:t,metadata:e}})});break}default:console.error("Unknown message type:",e.data.type)}});